<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Secret Memories by Mahak</title>

  <link href="https://fonts.googleapis.com/css2?family=Sawarabi+Mincho&family=Poppins:wght@400;600&display=swap"
    rel="stylesheet">

  <style>
    /* ---------- PALETTE & BASICS ---------- */
    :root {
      --pink: #ff8fab;
      --peach: #ffd6a5;
      --mint: #c4f0c5;
      --lav: #e4c3ff;
      --ink: #4b0049;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, var(--lav), var(--peach));
      min-height: 100vh;
      transition: background .4s, color .4s;
    }

    .night-mode {
      background: #1e1e1e;
      color: #f1f1f1
    }

    .night-mode .navbar {
      background: #2a2a3e
    }

    .night-mode .polaroid {
      background: #2c2c2c;
      color: #f1f1f1
    }

    /* ---------- NAVBAR ---------- */
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--pink);
      padding: 15px 40px;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 4px 6px rgba(0, 0, 0, .1)
    }

    .navbar .logo {
      font-family: 'Sawarabi Mincho', serif;
      font-size: 28px;
      color: #fff
    }

    .navbar ul {
      display: flex;
      list-style: none;
      gap: 25px
    }

    .navbar ul li a {
      color: #fff;
      text-decoration: none;
      font-weight: 600;
      transition: .3s
    }

    .navbar ul li a:hover {
      color: var(--mint)
    }

    /* ---------- NIGHTâ€‘MODE BUTTON ---------- */
    .toggle-btn {
      position: fixed;
      top: 85px;
      right: 20px;
      z-index: 1001;
      background: var(--pink);
      color: #fff;
      border: none;
      border-radius: 20px;
      padding: 10px 20px;
      cursor: pointer
    }

    @media(max-width:600px) {
      .toggle-btn {
        top: 75px;
      }
    }

    /* ---------- CONTAINER ---------- */
    .container {
      max-width: 900px;
      margin: 90px auto 40px;
      padding: 0 20px
    }

    h1 {
      font-family: 'Sawarabi Mincho', serif;
      text-align: center;
      color: var(--ink);
      font-size: 2.4rem;
      margin-bottom: 6px
    }

    .night-mode h1 {
      color: var(--mint)
    }

    .anime-tags {
      text-align: center;
      font-size: .9rem;
      margin-bottom: 30px;
      color: #555
    }

/* ------- UPGRADED POLAROID STYLE ------- */
.polaroid {
  --angle: -2deg;
  position: relative;
  background: #fff;
  border-radius: 12px;
  padding: 12px 12px 36px; /* extra bottom for caption */
  margin: 24px;
  width: 280px;
  box-shadow:
    0 8px 16px rgba(0, 0, 0, 0.2),
    0 2px 4px rgba(0, 0, 0, 0.1);
  transform: rotate(var(--angle));
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  cursor: pointer;
  overflow: hidden;
}

.polaroid:hover {
  transform: scale(1.05) rotate(calc(var(--angle) + 1deg));
  box-shadow:
    0 12px 24px rgba(0, 0, 0, 0.25),
    0 4px 8px rgba(0, 0, 0, 0.1);
}

.polaroid img {
  width: 100%;
  border-radius: 8px;
  display: block;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.polaroid:hover img {
  transform: scale(1.03);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
}

/* Optional caption inside Polaroid */
.polaroid .caption {
  position: absolute;
  bottom: 12px;
  left: 0;
  width: 100%;
  text-align: center;
  font-family: 'Pacifico', cursive;
  font-size: 16px;
  color: #333;
  opacity: 0.85;
  pointer-events: none;
}

/* Layout container */
.card-grid {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 24px;
  padding: 16px;
}

    /* ---------- PUZZLE ---------- */
#puzzle {
  position: relative;
  width: 300px;
  height: 300px;
  margin: auto;
  border: 3px solid #444;
  overflow: hidden;
  border-radius: 12px;
  background: #222;
}

.tile, .empty {
  position: absolute;
  width: 100px;
  height: 100px;
  transition: transform 0.2s;
}

.tile {
  background-size: 300px 300px;
  box-shadow: 0 0 3px rgba(0,0,0,0.3);
  cursor: pointer;
  border-radius: 6px;
}

.empty {
  background: transparent;
}

.correct {
  outline: 2px solid limegreen;
}

#solvedBanner {
  position: absolute;
  top: 40%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 24px;
  color: white;
  background: rgba(0,0,0,0.5);
  padding: 10px 20px;
  border-radius: 12px;
  display: none;
  z-index: 2;
}

#puzzle.solved #solvedBanner {
  display: block;
}

#completedImage{
  position:absolute;inset:0;
  background:url('ani2.jpg') center/cover no-repeat;
  border-radius:12px;
  box-shadow:0 0 20px rgba(255,255,255,.6),inset 0 0 40px rgba(255,255,255,.2);
  backdrop-filter:blur(2px) brightness(1.05);
  opacity:0;transition:opacity 1s ease-in-out;
  /*  âœ¨  THE TWO CRITICAL LINES  âœ¨  */
  pointer-events:none;   /* let clicks pass through */
  z-index:0;             /* stay below the tiles   */
}

/* keep tiles above the overlay */
.tile,.empty{position:absolute;width:100px;height:100px;transition:transform .25s;z-index:2}


#puzzle.solved #completedImage {
  opacity: 1;
}

    /* ---------- COMMENT WALL ---------- */
    #commentSection {
      margin: 60px 0
    }

    #commentForm {
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-width: 600px;
      margin: 0 auto
    }

    #commentInput {
      resize: none;
      height: 80px;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc
    }

    #commentForm button {
      align-self: flex-end;
      background: var(--pink);
      color: #fff;
      border: none;
      padding: 8px 18px;
      border-radius: 20px;
      cursor: pointer
    }

    .comment {
      max-width: 600px;
      margin: 20px auto;
      padding: 12px 18px;
      border-radius: 10px;
      background: rgba(255, 255, 255, .7);
      box-shadow: 0 3px 8px rgba(0, 0, 0, .15)
    }

    .night-mode .comment {
      background: rgba(40, 40, 40, .6)
    }

    /* ---------- HEART CURSOR ---------- */
    .heart {
      position: absolute;
      width: 20px;
      height: 20px;
      pointer-events: none;
      z-index: 9999;
      background: url('https://cdn-icons-png.flaticon.com/512/833/833472.png') center/contain no-repeat;
      animation: float 1s ease-out forwards
    }

    @keyframes float {
      0% {
        transform: translateY(0) scale(1);
        opacity: 1
      }

      100% {
        transform: translateY(-50px) scale(.5);
        opacity: 0
      }
    }

  
  </style>

  <script>
    /* apply stored mode instantly */
    if (localStorage.getItem('nightMode') === 'true') { document.documentElement.classList.add('night-mode'); }
  </script>
</head>

<body>
  <!-- NAVBAR -->
  <nav class="navbar">
    <div class="logo">MðŸ’˜P</div>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="#memories">Memories</a></li>
      <li><a href="#puzzleSection">Puzzle</a></li>
      <li><a href="#commentSection">Comments</a></li>
    </ul>
  </nav>

  <!-- Nightâ€‘mode button -->
  <button id="modeBtn" class="toggle-btn" onclick="toggleNightMode()">ðŸŒ™ Night Mode</button>

  <!-- MAIN -->
  <div class="container" id="memories">
    <h1>ðŸ’œ Secret Memories by Mahak</h1>
    <p class="anime-tags">Inspired by: Horimiya â€¢ LovingÂ YamadaÂ Lv999 â€¢ DemonÂ Slayer â€¢ DarlingÂ inÂ theÂ Franxx</p>
    <div class="card-grid" id="memoryGrid"></div>
  </div>

  <!-- PUZZLE -->
  <section id="puzzleSection">
    <h2 style="font-family:'Sawarabi Mincho',serif">ðŸ§© Solve the Puzzle to See Our Hidden Moment</h2>
    <div id="puzzle">
      <div id="completedImage"></div>
      <div id="solvedBanner">âœ¨â€¯Solved!â€¯âœ¨</div>
    </div>

  </section>

  <!-- COMMENTS -->
  <section id="commentSection">
    <h2 style="text-align:center;font-family:'Sawarabi Mincho',serif">ðŸ’¬ Leave a Sweet Note</h2>
    <form id="commentForm">
      <textarea id="commentInput" placeholder="Type something lovelyâ€¦" required></textarea>
      <button type="submit">Send</button>
    </form>
    <div id="commentList"></div>
  </section>

  <!-- TEMPLATE for polaroid -->
  <template id="cardTemplate">
    <div class="polaroid" style="--angle:0deg">
      <img>
      <div class="memory">
        <h3></h3>
        <p></p>
      </div>
    </div>
  </template>

  <script>
    /* ---------- HEART CURSOR ---------- */
    document.addEventListener('mousemove', e => {
      const h = document.createElement('div');
      h.className = 'heart';
      h.style.left = `${e.pageX}px`;
      h.style.top = `${e.pageY}px`;
      document.body.appendChild(h);
      setTimeout(() => h.remove(), 1000);
    });

    /* ---------- NIGHTâ€‘MODE ---------- */
    function setModeLabel() {
      document.getElementById('modeBtn').textContent =
        document.documentElement.classList.contains('night-mode') ? 'ðŸŒž Day Mode' : 'ðŸŒ™ Night Mode';
    }
    function toggleNightMode() {
      document.documentElement.classList.toggle('night-mode');
      localStorage.setItem('nightMode', document.documentElement.classList.contains('night-mode'));
      setModeLabel();
    }
    setModeLabel();

    /* ---------- POLAROID MEMORIES ---------- */
    const memories = [
      {
        date: 'ðŸ“… 6â€¯September',
        text: `Maine Prem se baat ki thiâ€¦<br>Dhireâ€‘dhire start kiya maine.<br>
         Phir humÂ sbâ€¯6Â log milke ludo khelte.<br>
         Mai jaanâ€‘buchÂ k uske bajuÂ mai gayi.<br>
         Uske sath bas baithneâ€¯k liyeâ€¦`,
        img: 'ani.jpg'
      },
      {
        date: 'ðŸ“… 12â€¯October',
        text: `Woh pehliÂ baar jab tu hastaâ€‘hasta
         aankhonÂ mein aansu leÂ aayiÂ thi â€”
         mujhe laga, yahÂ hiÂ tohÂ hai *perfect moment*Â âœ¨`,
        img: 'hig.jpg'
      },
      {
        date: 'ðŸ“… Valentineâ€™s Eve',
        text: `Ek chhotaâ€‘sa handmade card,
         *Horimiya* style doodle,
         aur teri *pagli* wali hasiÂ â€”Â bas,
         meri duniya complete hoÂ gayi!`,
        img: 'perfect.jpg'
      },
      {
        date: 'ðŸ“… 6â€¯September',
        text: `Maine Prem se baat ki thiâ€¦<br>Dhireâ€‘dhire start kiya maine.<br>
         Phir humÂ sbâ€¯6Â log milke ludo khelte.<br>
         Mai jaanâ€‘buchÂ k uske bajuÂ mai gayi.<br>
         Uske sath bas baithneâ€¯k liyeâ€¦`,
        img: 'ani.jpg'
      },
      {
        date: 'ðŸ“… 12â€¯October',
        text: `Woh pehliÂ baar jab tu hastaâ€‘hasta
         aankhonÂ mein aansu leÂ aayiÂ thi â€”
         mujhe laga, yahÂ hiÂ tohÂ hai *perfect moment*Â âœ¨`,
        img: 'hig.jpg'
      },
      {
        date: 'ðŸ“… Valentineâ€™s Eve',
        text: `Ek chhotaâ€‘sa handmade card,
         *Horimiya* style doodle,
         aur teri *pagli* wali hasiÂ â€”Â bas,
         meri duniya complete hoÂ gayi!`,
        img: 'perfect.jpg'
      },
    ];
    const grid = document.getElementById('memoryGrid');
    const tpl = document.getElementById('cardTemplate').content;
    memories.forEach((m, i) => {
      const n = tpl.cloneNode(true);
      n.querySelector('.polaroid').style.setProperty('--angle', `${-3 + i % 6}deg`);
      n.querySelector('img').src = m.img;
      n.querySelector('h3').innerText = m.date;
      n.querySelector('p').innerHTML = m.text;
      grid.appendChild(n);
    });

    /* ---------- PUZZLE ---------- */
    const SIZE = 3, TILE = 100, IMG = 'ani2.jpg';
    const board = document.getElementById('puzzle'); let tiles = [];
    function createPuzzle() {
      board.classList.remove('solved');
      board.innerHTML = `
  <div id="completedImage"></div>
  <div id="solvedBanner">âœ¨ Solved! âœ¨</div>
`;

      tiles = [];
      for (let i = 0; i < 9; i++) {
        const d = document.createElement('div');
        if (i < 8) {
          d.className = 'tile';
          const r = Math.floor(i / 3), c = i % 3;
          d.style.backgroundImage = `url('${IMG}')`;
          d.style.backgroundPosition = `-${c * TILE}px -${r * TILE}px`;
          d.dataset.correct = i;
          d.addEventListener('click', () => handleClick(d));
        } else d.className = 'empty';
        board.appendChild(d); tiles.push(d);
      }
      shuffle(30); positionTiles(); updateVisuals();
    }
    function positionTiles() {
      tiles.forEach((d, i) => {
        const r = Math.floor(i / 3), c = i % 3;
        d.style.transform = `translate(${c * TILE}px,${r * TILE}px)`
      })
    }
    function handleClick(d) {
      const idx = tiles.indexOf(d), empty = tiles.findIndex(t => t.classList.contains('empty'));
      if (isNeighbour(idx, empty)) {
        [tiles[idx], tiles[empty]] = [tiles[empty], tiles[idx]];
        positionTiles(); updateVisuals(); checkSolved();
      }
    }
    const isNeighbour = (a, b) => {
      const ar = Math.floor(a / 3), ac = a % 3, br = Math.floor(b / 3), bc = b % 3;
      return Math.abs(ar - br) + Math.abs(ac - bc) === 1;
    }
    function shuffle(t) {
      for (let k = 0; k < t; k++) {
        const e = tiles.findIndex(t => t.classList.contains('empty'));
        const n = [e - 3, e + 3, e - 1 * (e % 3 > 0), e + 1 * (e % 3 < 2)].filter(i => i >= 0 && i < 9);
        const s = n[Math.floor(Math.random() * n.length)];[tiles[s], tiles[e]] = [tiles[e], tiles[s]];
      }
      if (isSolved()) shuffle(t);
    }
    function updateVisuals() {
      tiles.forEach((d, i) => {
        if (d.classList.contains('tile')) {
          +d.dataset.correct === i ? d.classList.add('correct') : d.classList.remove('correct');
        }
      })
    }
    const isSolved = () => tiles.every((d, i) => d.classList.contains('empty') || +d.dataset.correct === i);
    function checkSolved() { if (isSolved()) board.classList.add('solved'); }
    createPuzzle();
  </script>

  <!--  NEW SCRIPT  :  Comment wall logic was previously outside any script tag -->
  <script>
  /* ---------- COMMENT WALL ---------- */
  const commentF = document.getElementById('commentForm');
  const commentIn = document.getElementById('commentInput');
  const commentList = document.getElementById('commentList');

  function loadComments() {
    commentList.innerHTML = '';
    (JSON.parse(localStorage.getItem('secretComments') || '[]')).forEach(c => {
      const d = document.createElement('div');
      d.className = 'comment';
      d.innerHTML = `${c.text}<br><span style="font-size:.8rem;color:#777">${c.time}</span>`;
      commentList.appendChild(d);
    });
  }

  commentF.addEventListener('submit', e => {
    e.preventDefault();
    const txt = commentIn.value.trim();
    if (!txt) return;
    const comments = JSON.parse(localStorage.getItem('secretComments') || '[]');
    const now = new Date().toLocaleString();
    comments.unshift({ text: txt, time: now });
    localStorage.setItem('secretComments', JSON.stringify(comments));
    commentIn.value = '';
    loadComments();
  });

  loadComments();
</script>

</body>

</html>
